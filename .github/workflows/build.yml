# Build Zotero plugin.

name: Build Zotero Swisscovery UB Bern plugin

on:
  pull_request:
    branches: [ "master" ]

jobs:
  build-plugin:
    name: Build and release plugin
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup git
        run: git config --global user.email "ci@example.com" && git config --global user.name "GitHub CI"
      
      - name: Install dependencies
        run: sudo apt update && sudo apt install jq

      - name: Run build
        run: ./build.sh $(git describe --tags || echo ci-test)

      - name: Prepare Update Manifests
        run: ./publish.sh $(git describe --tags || echo ci-test )

      - uses: actions/upload-artifact@v4
        with:
          name: Zotero Swisscovery UB Bern plugin (zipped)
          path: "build/*.xpi"
